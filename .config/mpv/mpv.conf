# https://github.com/classicjazz/mpv-config/blob/master/mpv.conf
# https://github.com/mpv-player/mpv/blob/master/etc/builtin.conf
# https://github.com/mpv-player/mpv/blob/master/DOCS/man/options.rst

profile=high-quality
vo=gpu-next
gpu-api=vulkan
hwdec=auto-safe

vulkan-async-compute=yes
vulkan-async-transfer=yes
vulkan-queue-count=2
vulkan-swap-mode=mailbox
vd-lavc-dr=yes

deinterlace=no
deband=yes
interpolation=yes # toggle with "i"
tscale=oversample
temporal-dither=yes
dither-depth=auto
dither=fruit

linear-downscaling=yes
sigmoid-upscaling=yes
correct-downscaling=yes

target-colorspace-hint=yes
target-peak=auto
target-prim=auto
target-trc=auto
vf=format=colorlevels=full:colormatrix=auto
video-output-levels=full
hdr-compute-peak=yes
inverse-tone-mapping=yes

video-sync=display-resample
volume=100
volume-max=100

sub-auto=fuzzy
sub-fix-timing=yes
slang=en
save-position-on-quit
reset-on-next-file=audio-delay,mute,pause,speed,sub-delay,video-aspect-override,video-pan-x,video-pan-y,video-rotate,video-zoom,volume

ytdl=yes
ytdl-format=bestvideo[height<=?2160][fps<=?60]+bestaudio/best
ytdl-raw-options-append="sub-format=best,sub-langs=en.*,sleep-interval=4,write-sub=,write-auto-sub="

[protocol.http]
hls-bitrate=max
cache=yes
cache-pause-initial=yes
cache-pause-wait=5
demuxer-max-bytes=512M
demuxer-readahead-secs=10

[protocol.https]
profile=protocol.http

[protocol.ytdl]
profile=protocol.http

[anime] # activate with "alt+1"
deband=no
# glsl-shaders="~~/shaders/Anime4K_Clamp_Highlights.glsl:~~/shaders/Anime4K_Restore_CNN_M.glsl:~~/shaders/Anime4K_Upscale_CNN_x2_M.glsl:~~/shaders/Anime4K_AutoDownscalePre_x2.glsl:~~/shaders/Anime4K_AutoDownscalePre_x4.glsl:~~/shaders/Anime4K_Upscale_CNN_x2_S.glsl"

[heavy-decode video] # activate with "alt+2"
profile-cond=(video_format == 'vp9' or video_format == 'av1') and (height > 1080 or height >= display_height)
# profile=fast
# gpu-api=opengl
# opengl-swapinterval=1
video-sync=audio
demuxer-readahead-secs=2
glsl-shaders=""

[high-fps video]
profile-cond=container_fps >= 30
interpolation=no

[upscale]
profile-cond=height < display_height and estimated_frame_count > 2
glsl-shader="~~/shaders/ravu-lite-ar-r4.hook"

[interlaced]
profile-cond=p["video-frame-info/interlaced"]
deinterlace=yes

[nogpu] # activate with "alt+3"
vo=wlshm
profile=sw-fast

[lowend] # activate with "alt+4"
profile=fast
vo=gpu
gpu-api=auto
hwdec=no
video-sync=display-desync
glsl-shaders=""

[hifi audio] # activate with "alt+8"
# profile=low-latency
ao=pipewire
audio-device=auto
video-sync=audio
audio-channels=stereo
audio-normalize-downmix=no
af=""

[k3-dac audio] # activate with "alt+9"
profile="hifi audio"
# ao=alsa
# audio-device=alsa/hw:CARD=K3,DEV=0
audio-exclusive=yes
audio-samplerate=48000
audio-format=s32
